<html>

<head>
    <title>SignUp page</title>
    <link rel="stylesheet" type="text/css" href="CSS/signup_superadmin.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous"> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> -->
</head>

<body>
    <div class="signupbox">
        <img src="images/3300.jpg" class="car">
        <h1>Sign Up</h1>
        <span id="success" style="color: rgb(122, 211, 32); display: none; text-align: center; font-size: 20px;">*
            Details updated successfully</span>
        <span id="emailexists" style="color: #dc1c1c; display: none; text-align: center; font-size: 20px;">* Email
            address already exists</span>
        <form>
            <input type="text" id="fullname" placeholder="Full name"><br>
            <input type="date" id="dob" onmouseover="myFunction1()" onmouseleave="myFunction2()"
                placeholder="Date of Birth">
            <input type="text" id="age" placeholder="Age" readonly><br>
            <input type="email" id="email" placeholder="Email-Id">
            <input type="text" id="mob" placeholder="Mobile number"><br>
            <input type="text" id="presentaddress" placeholder="Present address"><br>
            <input type="text" id="permanentaddress" placeholder="Permanent address"><br>
            <input type="password" id="password" placeholder="Password">
            <input type="password" id="confirmpassword" placeholder="Confirm password"><br>
            <select id="role">
                <option value="1">Super admin</option>
                <option value="2">Sub admin-EDIT</option>
                <option value="3">Sub admin-VERIFY</option>
                <option value="4">User</option>
            </select><br>
            <input type="submit" id="submit" onclick="signupbtnhandler();event.preventDefault();" value="Register">
        </form>
        <hr color="grey">
        
        <button id="loginbttn" onclick="dashbttnhandler();event.preventDefault();">Dashboard</button>
    </div>

    <script>
        //DATE OF BIRTH HOVER
        var birth = document.getElementById("dob");
        var age1 = document.getElementById("age");
        birth.addEventListener("input", function () { age1.value = calcage(birth.value) });

        function myFunction1() {
            var x = document.getElementById("dob");
            x.type = "date";
        }

        function myFunction2() {
            var x = document.getElementById("dob");
            x.type = "text";
        }

        function calcage(dob) {
            var today = new Date();
            var birth = new Date(dob);
            var age = today.getFullYear() - birth.getFullYear();
            var month = today.getMonth() - birth.getMonth();
            var date = today.getDate() - birth.getDate();
            if (month < 0 || (month === 0 && date < 0)) {
                age--;
            }
            return age;
        }

        function signupbtnhandler() {
            var fullname = document.getElementById("fullname").value;
            var dob = document.getElementById("dob").value;
            var age = document.getElementById("age").value;
            var email = document.getElementById("email").value;
            var mob = document.getElementById("mob").value;
            var presentaddress = document.getElementById("presentaddress").value;
            var permanentaddress = document.getElementById("permanentaddress").value;
            var password = document.getElementById("password").value;
            var confirmpassword = document.getElementById("confirmpassword").value;
            var role = document.getElementById("role").value;
            var data = {
                name: fullname,
                dob: dob,
                age: age,
                email: email,
                mob: mob,
                presentAddress: presentaddress,
                permanentAddress: permanentaddress,
                pwd: password,
                role: role,
                status:1,
                created_by : localStorage.getItem("login_id") 
            }
            console.log(data)
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "http://localhost:8080/employee/register", true);
            xhr.setRequestHeader("Content-Type", "application/JSON;charset-UTF8");
            xhr.onload = function () {
                var msg = xhr.responseText;
                console.log(msg);
                // if(msg!="Failed to register")
                if (msg == 0) {
                    document.getElementById("emailexists").style.display = "block";
                    document.getElementById("fullname").value="";
                    document.getElementById("dob").value="";
                    document.getElementById("age").value="";
                    document.getElementById("email").value="";
                    document.getElementById("mob").value="";
                    document.getElementById("presentaddress").value="";
                    document.getElementById("permanentaddress").value="";
                    document.getElementById("password").value="";
                    document.getElementById("confirmpassword").value="";
                }
                else {
                    document.getElementById("emailexists").style.display = "none";
                    document.getElementById("success").style.display = "block";
                    document.getElementById("fullname").style.display = "none";
                    document.getElementById("dob").style.display = "none";
                    document.getElementById("age").style.display = "none";
                    document.getElementById("email").style.display = "none";
                    document.getElementById("mob").style.display = "none";
                    document.getElementById("presentaddress").style.display = "none";
                    document.getElementById("permanentaddress").style.display = "none";
                    document.getElementById("password").style.display = "none";
                    document.getElementById("confirmpassword").style.display = "none";
                    document.getElementById("role").style.display = "none";
                    document.getElementById("submit").style.display = "none";
                    
                }

            }
            xhr.send(JSON.stringify(data));
        }

        function dashbttnhandler() {
            window.location.href = "dash_superadmin.html";
        }

        
    </script>
</body>

</html>